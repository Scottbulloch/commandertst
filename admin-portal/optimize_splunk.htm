<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Side_Navigation_Skin_SnowDocs" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../" data-mc-has-content-body="True" data-mc-toc-path="Admin Portal|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]" data-mc-conditions="General.NotForSPBuildHelp,Disaster.remove-splunk" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../Skins/Favicons/browserconfig.xml" />
        <meta http-equiv="Content-Style-Type" content="text/css" />
        <link rel="apple-touch-icon" sizes="180x180" href="../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../Skins/Favicons/favicon-16x16.png" /><title>Optimize the VM Performance Query with Splunk</title>
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <meta charset="utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Resources/Stylesheets/Styles.css" rel="stylesheet" type="text/css" />
        <link href="../Resources/fontAwesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
        <link href="../Resources/Stylesheets/roboto.font.css" rel="stylesheet" type="text/css" />
        <style>*
{
	box-sizing: border-box;
}

/* Create two columns that float next to each other */

.column
{
	
}

.column2
{
	
}

/* Clear floats after the columns */

.row:after
{
	content: "";
	display: table;
	clear: both;
}

</style>
        <style>/*&lt;meta /&gt;*/

.button.print-button
{
	-pie-background: linear-gradient(#ffffff, #ffffff);
}

.needs-pie
{
	behavior: url('../Resources/Scripts/PIE.htc');
}

</style>
        <style>/*&lt;meta /&gt;*/

.button.home-button
{
	-pie-background: url('../Skins/Default/Stylesheets/Images/home-fa-18w.png') no-repeat center center, linear-gradient(transparent, transparent);
}

.needs-pie
{
	behavior: url('../Resources/Scripts/PIE.htc');
}

</style>
        <style>/*&lt;meta /&gt;*/

.button.previous-topic-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.needs-pie
{
	behavior: url('../Resources/Scripts/PIE.htc');
}

</style>
        <style>/*&lt;meta /&gt;*/

.button.next-topic-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.needs-pie
{
	behavior: url('../Resources/Scripts/PIE.htc');
}

</style>
        <link href="../Resources/TableStyles/AccessAndAvailability.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link href="../Resources/TableStyles/Standard.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link rel="apple-touch-icon" sizes="180x180" href="../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../Skins/Favicons/favicon-16x16.png" />
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
        <script src="https://www.googletagmanager.com/gtag/js?id=G-L05Y74KND5" async="async">
        </script>
        <script>/*<![CDATA[*/  window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());

		gtag('config', 'G-L05Y74KND5');/*]]>*/</script>
        <script defer="defer" src="../Resources/Scripts/scroll_to_top_left_nav.js" type="text/javascript">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 900px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="https://docs.snowsoftware.com" title="Docs Portal Home" alt="Docs Portal Home"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="All Commander Docs" title="All Commander Docs" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Commander Docs</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div style="width: 100%; overflow: hidden;"><span class="hide-when-mobile"><div><div class="buttons popup-container clearfix topicToolbarProxy _Skins_TopicToolBarPrint mc-component nocontent" style="mc-topic-toolbar-items: Print;"><div class="button-group-container-left"><button class="button needs-pie print-button" title="Print this page"><div><div role="img" class="button-icon-wrapper" aria-label="Print"><div class="button-icon"> </div></div></div></button></div></div><a href="/commander/index.htm"><div class="buttons popup-container clearfix topicToolbarProxy _Skins_TopicToolBarHome mc-component nocontent" style="mc-topic-toolbar-items: Home;"><div class="button-group-container-left"><button class="button needs-pie home-button" title="Commander Docs Home"><div><div role="img" class="button-icon-wrapper"><div class="button-icon"> </div></div></div></button></div></div></a></div><div style="float: right; padding-right: 25px; padding-left: 25px;"><a href="https://www.snowsoftware.com" target="_blank" style="font-size: 11px; color: #606f7b;">snowsoftware.com</a>&#160;&#160;&#160;</div></span><span id="home-link"><a style="font-size: 11px;font-style: normal;color: #606f7b;" href="../index.htm">Commander</a> / </span>
                                        <div class="nocontent">
                                            <div class="MCBreadcrumbsBox_SnowDocs_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" / " data-mc-breadcrumbs-count="3" data-mc-toc="True">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="column"> <div role="main" id="mc-main-content"><h1 id="OptimizetheVMPerformanceQuerywithSplunk" data-magellan-target="OptimizetheVMPerformanceQuerywithSplunk"><a name="aanchor381"></a><MadCap:concept term="Admin Portal" />Optimize the VM Performance Query with Splunk</h1><p>If you have <a href="perf_integration.htm" class="hreflinks">integrated with Splunk</a> to retrieve guest OS performance data, when Commander refreshes VM performance for a machine (either manually for a single VM, or automatically with the nightly performance update), Commander generates a query for the VM and sends it to Splunk to perform. This query can take a long time to complete, especially when every VM in your environment is being queried. To reduce the time taken and reduce the load on your Splunk server when performance data is being requested, you can configure Splunk to run these queries for all the hosts in your environment and store the results for Commander to fetch later.</p><p class="Note"> Make sure you run each saved search at least once in Splunk to generate the index. Otherwise, the index must be generated when Commander executes the search for the first time, resulting in a very slow performance update.</p><h2 id="Aboutperformancesamplesize" data-magellan-target="Aboutperformancesamplesize"><a name="sample_size"></a>About performance sample size</h2><p>Before configuring the saved searches in Splunk, you need to understand how Commander treats the performance data it retrieves. For each performance counter (for example, Percent CPU), Commander retrieves a daily sample from Splunk and detects how many days of performance data are available; the number of days Commander retrieves is known as the sample size. Commander uses both the sample size and the number of available samples to determine whether this performance data can be used to drive recommendations. For example, if a machine is only active on weekdays and you would like to make sure that a week's data is present before applying it to recommendations, configure the sample size to be 5 and the minimum number of days in the sample to be 7.</p><p>You will need the sample size when configuring the searches in Splunk. The example queries in this topic use the numbers given above: sample size = 5 days, and minimum number of samples = 7.</p><h2 id="ConfigureAcceleratedSearchinSplunk" data-magellan-target="ConfigureAcceleratedSearchinSplunk"><a name="config_splunk"></a>Configure Accelerated Search in Splunk</h2><p>By making use of the Report Acceleration Summaries feature in Splunk, you can predefine a search that's run once for each performance counter that Commander needs to refresh. You must ensure that report acceleration has been enabled for each query, and that the query has been scheduled to run once a day. Since Commander summarizes the data daily, it's not necessary for Splunk to perform the query multiple times in a day; just make sure that the query runs before midnight, when the nightly performance job in Commander starts.</p><p class="Note">These instructions assume that you have already created and configured the data inputs for the target hosts.</p><h3><a name="percent_cpu"></a>Percent CPU Performance Counter</h3><p>In Splunk, create a new report with the following settings. See <a href="#customize" class="MCXref xref">Customize the Splunk Accelerated Search</a> below if you need to specify different values for Destination App or Search Name.</p><table style="width: 100%;mc-table-style: url('../Resources/TableStyles/Standard.css');" class="TableStyle-Standard" cellspacing="0"><tr class="TableStyle-Standard-Body-Row1"><td class="TableStyle-Standard-BodyE-Regular-Row1"><p><b>Destination app</b></p></td><td class="TableStyle-Standard-BodyD-Regular-Row1"><p>Search</p></td></tr><tr class="TableStyle-Standard-Body-Row1"><td class="TableStyle-Standard-BodyE-Regular-Row1"><p><b>Search name</b></p></td><td class="TableStyle-Standard-BodyD-Regular-Row1"><p>vCommander-windows-cpu</p></td></tr><tr class="TableStyle-Standard-Body-Row1"><td class="TableStyle-Standard-BodyE-Regular-Row1"><p><b>Available object</b></p></td><td class="TableStyle-Standard-BodyD-Regular-Row1"><p>
                        PerfOS_Processor</p></td></tr><tr class="TableStyle-Standard-Body-Row1"><td class="TableStyle-Standard-BodyE-Regular-Row1"><b>Counters</b></td><td class="TableStyle-Standard-BodyD-Regular-Row1"><p>PercentProcessorTime</p><p>Name (optional)</p></td></tr><tr class="TableStyle-Standard-Body-Row1"><td class="TableStyle-Standard-BodyE-Regular-Row1"><p><b>Search</b></p></td><td class="TableStyle-Standard-BodyD-Regular-Row1"><p>PercentProcessorTime=* Name=_Total latest=@d earliest=@d-7d | bucket _time span=5m | stats avg(PercentProcessorTime) as avgBucketValue, min(_time) as minBucketTime, max(_time) as maxBucketTime by host, _time | bucket _time span=1d | stats avg(avgBucketValue) as AVERAGE, max(avgBucketValue) as PEAK, min(minBucketTime) as minDayTime, max(maxBucketTime) as maxDayTimeUnadjusted by host, _time | eval maxDayTime = maxDayTimeUnadjusted + 300</p><p>Change the value of the <b>earliest</b> parameter to match your sample size. For example, to sample a month's data, change the earliest value to: <b>earliest=@d-30d</b></p></td></tr><tr class="TableStyle-Standard-Body-Row1"><td class="TableStyle-Standard-BodyE-Regular-Row1"><p><b>Accelerate this search</b></p></td><td class="TableStyle-Standard-BodyD-Regular-Row1"><p>Enabled</p></td></tr><tr class="TableStyle-Standard-Body-Row1"><td class="TableStyle-Standard-BodyE-Regular-Row1"><p><b>Summary range</b></p></td><td class="TableStyle-Standard-BodyD-Regular-Row1"><p>Must be greater than the sample size you've chosen</p></td></tr><tr class="TableStyle-Standard-Body-Row1"><td class="TableStyle-Standard-BodyE-Regular-Row1"><p><b>Schedule this search</b></p></td><td class="TableStyle-Standard-BodyD-Regular-Row1"><p>Enabled</p></td></tr></table><h3><a name="avail_bytes"></a>Available Bytes Performance Counter</h3><p>In Splunk, create a new search with the following settings. See <a href="#customize" class="MCXref xref">Customize the Splunk Accelerated Search</a> below if you need to specify different values for Destination App or Search Name.</p><table class="TableStyle-Standard" cellspacing="0" style="width: 100%;mc-table-style: url('../Resources/TableStyles/Standard.css');"><tr class="TableStyle-Standard-Body-Row1"><td style="width: 228px;" class="TableStyle-Standard-BodyE-Regular-Row1"><p><b>Destination app</b></p></td><td style="width: 581px;" class="TableStyle-Standard-BodyD-Regular-Row1"><p>Search</p></td></tr><tr class="TableStyle-Standard-Body-Row1"><td style="width: 228px;" class="TableStyle-Standard-BodyE-Regular-Row1"><p><b>Search name</b></p></td><td style="width: 581px;" class="TableStyle-Standard-BodyD-Regular-Row1"><p>vCommander-windows-available-bytes</p></td></tr><tr class="TableStyle-Standard-Body-Row1"><td style="width: 228px;" class="TableStyle-Standard-BodyE-Regular-Row1"><p><b>Available object</b></p></td><td style="width: 581px;" class="TableStyle-Standard-BodyD-Regular-Row1"><p>PerfOS_Memory</p></td></tr><tr class="TableStyle-Standard-Body-Row1"><td style="width: 228px;" class="TableStyle-Standard-BodyE-Regular-Row1"><b>Counters</b></td><td style="width: 581px;" class="TableStyle-Standard-BodyD-Regular-Row1"><p>AvailableBytes</p></td></tr><tr class="TableStyle-Standard-Body-Row1"><td style="width: 228px;" class="TableStyle-Standard-BodyE-Regular-Row1"><p><b>Search</b></p></td><td style="width: 581px;" class="TableStyle-Standard-BodyD-Regular-Row1"><p>AvailableBytes=* latest=@d earliest=@d-7d | bucket _time span=5m | stats avg(AvailableBytes) as avgBucketValue, min(_time) as minBucketTime, max(_time) as maxBucketTime by host, _time | bucket _time span=1d | stats min(avgBucketValue) as PEAK, min(minBucketTime) as minDayTime, max(maxBucketTime) as maxDayTimeUnadjusted by host, _time | eval maxDayTime = maxDayTimeUnadjusted + 300</p><p>Change the value of the <b>earliest</b> parameter to match your sample size. For example, to sample a month's data, change the earliest value to: <b>earliest=@d-30d</b></p></td></tr><tr class="TableStyle-Standard-Body-Row1"><td style="width: 228px;" class="TableStyle-Standard-BodyE-Regular-Row1"><p><b>Accelerate this search</b></p></td><td style="width: 581px;" class="TableStyle-Standard-BodyD-Regular-Row1"><p>Enabled</p></td></tr><tr class="TableStyle-Standard-Body-Row1"><td style="width: 228px;" class="TableStyle-Standard-BodyE-Regular-Row1"><p><b>Summary range</b></p></td><td style="width: 581px;" class="TableStyle-Standard-BodyD-Regular-Row1"><p>Must be greater than the sample size you have chosen
                        </p></td></tr><tr class="TableStyle-Standard-Body-Row1"><td style="width: 228px;" class="TableStyle-Standard-BodyE-Regular-Row1"><p><b>Schedule this search</b></p></td><td style="width: 581px;" class="TableStyle-Standard-BodyD-Regular-Row1"><p>Enabled</p></td></tr></table><h3><a name="pages_output"></a>Pages Output per Second Performance Counter</h3><p>In Splunk, create a new search with the following settings. See <a href="#customize" class="MCXref xref">Customize the Splunk Accelerated Search</a> below if you need to specify different values for Destination App or Search Name.</p> <table class="TableStyle-Standard" cellspacing="0" style="width: 100%;mc-table-style: url('../Resources/TableStyles/Standard.css');"><tr class="TableStyle-Standard-Body-Row1"><td style="width: 226px;" class="TableStyle-Standard-BodyE-Regular-Row1"><p><b>Destination app</b></p></td><td style="width: 582px;" class="TableStyle-Standard-BodyD-Regular-Row1"><p>Search</p></td></tr><tr class="TableStyle-Standard-Body-Row1"><td style="width: 226px;" class="TableStyle-Standard-BodyE-Regular-Row1"><p><b>Search name</b></p></td><td style="width: 582px;" class="TableStyle-Standard-BodyD-Regular-Row1"><p>vCommander-windows-pages-output-per-sec</p></td></tr><tr class="TableStyle-Standard-Body-Row1"><td style="width: 226px;" class="TableStyle-Standard-BodyE-Regular-Row1"><p><b>Available object</b></p></td><td style="width: 582px;" class="TableStyle-Standard-BodyD-Regular-Row1"><p>PerfOS_Memory</p></td></tr><tr class="TableStyle-Standard-Body-Row1"><td style="width: 226px;" class="TableStyle-Standard-BodyE-Regular-Row1"><b>Counters</b></td><td style="width: 582px;" class="TableStyle-Standard-BodyD-Regular-Row1"><p>PagesOutputPersec</p></td></tr><tr class="TableStyle-Standard-Body-Row1"><td style="width: 226px;" class="TableStyle-Standard-BodyE-Regular-Row1"><p><b>Search</b></p></td><td style="width: 582px;" class="TableStyle-Standard-BodyD-Regular-Row1"><p>PagesOutputPersec=* latest=@d earliest=@d-7d | bucket _time span=5m | stats avg(PagesOutputPersec) as avgBucketValue, min(_time) as minBucketTime, max(_time) as maxBucketTime by host, _time | bucket _time span=1d | stats avg(avgBucketValue) as AVERAGE, max(avgBucketValue) as PEAK, min(minBucketTime) as minDayTime, max(maxBucketTime) as maxDayTimeUnadjusted by host, _time | eval maxDayTime = maxDayTimeUnadjusted + 300</p><p>Change the value of the <b>earliest</b> parameter to match your sample size. For example, to sample a month's data, change the earliest value to: <b>earliest=@d-30d</b></p></td></tr><tr class="TableStyle-Standard-Body-Row1"><td style="width: 226px;" class="TableStyle-Standard-BodyE-Regular-Row1"><p><b>Accelerate this search</b></p></td><td style="width: 582px;" class="TableStyle-Standard-BodyD-Regular-Row1"><p>Enabled</p></td></tr><tr class="TableStyle-Standard-Body-Row1"><td style="width: 226px;" class="TableStyle-Standard-BodyE-Regular-Row1"><p><b>Summary range</b></p></td><td style="width: 582px;" class="TableStyle-Standard-BodyD-Regular-Row1"><p>Must be greater than the sample size you've chosen </p></td></tr><tr class="TableStyle-Standard-Body-Row1"><td style="width: 226px;" class="TableStyle-Standard-BodyE-Regular-Row1"><p><b>Schedule this search</b></p></td><td style="width: 582px;" class="TableStyle-Standard-BodyD-Regular-Row1"><p>Enabled</p></td></tr></table><h2 data-mc-conditions="Disaster.remove-splunk" id="ConfigureCommandertouseSplunkAcceleratedSearch" data-magellan-target="ConfigureCommandertouseSplunkAcceleratedSearch"><a name="config_vcmdr"></a>Configure Commander to use Splunk Accelerated Search</h2><table style="width: 100%;mc-table-style: url('../Resources/TableStyles/AccessAndAvailability.css');" class="TableStyle-AccessAndAvailability" cellspacing="0"><tr class="TableStyle-AccessAndAvailability-Body-Body1"><td class="TableStyle-AccessAndAvailability-BodyE-Column1-Body1"><p data-mc-conditions="Disaster.remove-splunk"><b>Access:</b></p></td><td class="TableStyle-AccessAndAvailability-BodyD-Column2-Body1"><p data-mc-conditions="Disaster.remove-splunk">Configuration &gt; System &gt; Integration tab</p></td></tr><tr class="TableStyle-AccessAndAvailability-Body-Body1"><td class="TableStyle-AccessAndAvailability-BodyE-Column1-Body1"><p data-mc-conditions="Disaster.remove-splunk"><b>Available to:</b></p></td><td class="TableStyle-AccessAndAvailability-BodyD-Column2-Body1"><p data-mc-conditions="Disaster.remove-splunk">Commander Role of Superuser</p></td></tr></table><p data-mc-conditions="Disaster.remove-splunk">To configure Commander to make use of the saved searches to update performance data:</p><ol><li value="1" data-mc-conditions="Disaster.remove-splunk">On the Integration page, under <b>Splunk Server</b>, click <b>Edit</b>.</li><li value="2" data-mc-conditions="Disaster.remove-splunk">In the Splunk Server dialog, enable <b>Accelerate Searches</b>.</li><li value="3" data-mc-conditions="Disaster.remove-splunk">Click <b>Test</b>.
                <p data-mc-conditions="Disaster.remove-splunk">Commander queries Splunk to determine whether everything is set up correctly.</p></li><li value="4" data-mc-conditions="Disaster.remove-splunk">Once the test has succeeded, click <b>OK</b> to save the configuration.
			</li></ol><p class="Note" data-mc-conditions="Disaster.remove-splunk">If Splunk has been misconfigured and Accelerate Searches is enabled, Commander won't be able to retrieve performance data from Splunk until the Splunk configuration has been corrected.</p><h2 id="CustomizetheSplunkAcceleratedSearch" data-magellan-target="CustomizetheSplunkAcceleratedSearch"><a name="customize"></a>Customize the Splunk Accelerated Search</h2><h3>Use Different Values for Destination App or Search Name</h3><p>Commander expects the Splunk values for Destination App and Search Name to match those in the tables above. If you can't use the expected values (for example, if you need to point to a differently named app, or if you have a policy for search names), you can customize these values.</p><ol><li value="1">Create a <code>splunk.properties</code> file in the <span style="word-wrap:anywhere;"><code>&lt;vcommander_install_dir&gt;/tomcat/common/classes</code></span> directory.</li><li value="2">Use the standard property file format, one property per line:
        <p class="code">property1=value1</p><p class="code">property2=value2</p><p class="code">...</p></li><li value="3">Add the following properties:</li></ol><ul><li><code>splunk.properties.application</code>
 — The name of the application where the searches have been created. The default value is <code>search</code>.</li><li><code>splunk.performance.windows.percent_cpu</code>

 — The name of the saved search for reading the percent CPU performance counter. The default value is <code>vCommander-windows-cpu</code>.                            </li><li><code>splunk.performance.windows.available_bytes</code>

 — The name of the saved search for reading the available bytes performance counter. The default value is <code>vCommander-windows-available-bytes</code>.</li><li><code>splunk.performance.windows.pages_out_per_sec</code>

 — The name of the saved search for reading the pages output per second performance counter. The default value is <code>vCommander-windows-pages-out-per-sec</code>.</li></ul><h3>Customize the Search Query</h3><p>VMware takes the average value of every counter in a five-minute sampling period and uses that value for its calculations. Performance queries used by Commander are likewise broken into five-minute intervals to match the way VMware retrieves performance data. Commander identifies the peak value and the average value for the day; these values are used to drive rightsizing recommendations.</p><p>In order for Commander to use both VM and Guest OS performance data to drive rightsizing recommendations, the two counters need to be comparable. Keep this in mind if you want to customize the search query.</p></div><div><div style="border-top-color: rgb(245, 245, 245); border-top-style: none; border-top-width: 1px; margin-top: 22px;"><br /><div class="buttons popup-container clearfix topicToolbarProxy _Skins_ToolbarSnowDocsBottomLeft mc-component nocontent" style="mc-topic-toolbar-items: PreviousTopic;"><div class="button-group-container-left"><button class="button needs-pie previous-topic-button" title="Previous Topic" disabled="true"><div><div role="img" class="button-icon-wrapper" aria-label="Previous Topic"><div class="button-icon"> </div></div></div></button></div></div><div class="buttons popup-container clearfix topicToolbarProxy _Skins_ToolbarSnowDocsBottomRight mc-component nocontent" style="mc-topic-toolbar-items: NextTopic;"><div class="button-group-container-left"><button class="button needs-pie next-topic-button" title="Next Topic" disabled="true"><div><div role="img" class="button-icon-wrapper" aria-label="Next Topic"><div class="button-icon"> </div></div></div></button></div></div><p>&#160;</p><div style="border-top-color: rgb(245, 245, 245); border-top-style: solid; border-top-width: 1px; margin-top: 22px;"><p>&#160;</p></div><p class="footer-logo">Snow Commander <span class="mc-variable General.VersionShort variable">9.6</span> documentation</p><p class="footer-logo"><img src="../Resources/Images/copyright-regular-8.svg" /> <span class="mc-variable General.Year variable">2024</span> <span class="mc-variable General.CompanyName variable">Snow Software</span>&#160;&#160;&#160;Last modified: <span class="mc-variable General.ISOShortDate variable">2024-05-21</span>&#160;&#160;&#160;<span style="color: #FFF;" class="mc-variable System.ShortTime variable">7:04 PM</span></p><p class="footer-logo"><a class="footer-links-herschel" href="https://www.snowsoftware.com/legal/termsofuse" target="_blank" data-mc-conditions="General.ForWebOnly">Terms of use</a>&#160;&#160;&#160;<a class="footer-links-herschel" href="https://www.snowsoftware.com/seo/legal-privacy-policy" target="_blank" data-mc-conditions="General.ForWebOnly">Privacy policy</a>&#160;&#160;&#160;<a class="footer-links-herschel" href="https://www.snowsoftware.com/legal/dataprotection" target="_blank">Data protection</a>&#160;&#160;&#160;<a class="footer-links-herschel" href="https://go.snowsoftware.com/subscription-center.html" target="_blank">Subscription&#160;center</a>&#160;&#160;&#160;<a class="footer-links-herschel" href="https://community.snowsoftware.com/s" target="_blank">Community</a>&#160;&#160;&#160;<a class="footer-links-herschel" href="mailto:docsportal-feedback@snowsoftware.com" target="_blank">Docs Feedback</a></p><p><span class="hide-when-mobile"><span style="color: #ffffff;" class="mc-variable System.ShortDate variable">5/21/2024</span>&#160;&#160;<span style="color: #ffffff;" class="mc-variable System.ShortTime variable">7:04 PM</span>&#160;&#160;<span style="color: #ffffff;" class="mc-variable General.Version variable">9.6.3</span></span></p></div></div></div>
                                        <div class="column2">
                                            <div data-sticky-container="" id="NNpr_eSDuU22iepDXAyw8g">
                                                <div class="sticky sticky-menu" style="width:100%" data-sticky="" data-top-anchor="NNpr_eSDuU22iepDXAyw8g:top" data-bottom-anchor="contentBody:bottom" data-scroll-container=".body-container" data-sticky-on="only screen and (min-width: 901px)" data-scroll-container-on="only screen and (min-width: 901px)">
                                                    <ul data-magellan="" data-animation-duration="250" data-active-class="selected" data-scroll-container=".body-container" data-scroll-container-on="only screen and (min-width: 901px)" class="nocontent menu _Skins_SideMenuWithInThisTopicColumn mc-component">
                                                        <li><a href="#OptimizetheVMPerformanceQuerywithSplunk">Optimize the VM Performance Query with Splunk</a>
                                                        </li>
                                                        <ul>
                                                            <li><a href="#Aboutperformancesamplesize">About performance sample size</a>
                                                            </li>
                                                            <li><a href="#ConfigureAcceleratedSearchinSplunk">Configure Accelerated Search in Splunk</a>
                                                            </li>
                                                            <li><a href="#ConfigureCommandertouseSplunkAcceleratedSearch">Configure Commander to use Splunk Accelerated Search</a>
                                                            </li>
                                                            <li><a href="#CustomizetheSplunkAcceleratedSearch">Customize the Splunk Accelerated Search</a>
                                                            </li>
                                                        </ul>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <p class="scrollup" style="margin-bottom: 0px; margin-left: 17px;"><a id="scrollup" style="cursor: pointer;">Scroll</a>
                                    </p>
                                    <p>
                                        <!-- This referenced snippet allows an alt text statement to be included for the logo/go-home button on the top of each page -->
                                        <script>/*<![CDATA[*/$(document).ready(function(){
   $('a.logo').attr({
     alt: 'Snow Docs Home',
     title: 'Snow Docs Home'
   });
});/*]]>*/</script>
                                    </p>
                                    <script type="text/javascript">/*<![CDATA[*/if ($(".sticky-menu > ul").children("ul").length == 0){
        $(".sticky-menu > ul").css("visibility", "hidden");
    }/*]]>*/</script>
                                    <script defer="defer" src="../Resources/Scripts/scroll_to_top_left_nav.js" type="text/javascript">
                                    </script>
                                    <script type="text/javascript">/*<![CDATA[*/$("#home-link").prependTo("div.MCBreadcrumbsBox_SnowDocs_0");/*]]>*/</script>
                                    <script type="text/javascript" src="../Resources/Scripts/fa_ext_link.js">
                                    </script>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>